# 设备管理员

_注：此外的接口属于梯控调度平台支持接口，不对外开放给客户_

## 创建产品

在梯控调度平台中，电梯与机器人都将被视为物联网设备进行管理。而管理物联网设备首先需要为不同的物联网设备创建产品，并在该产品上注册具体的设备实例

### 示例-创建电梯产品

- 请求

```http takingRequest
POST thing/thing-models

{
    "name": "鲁邦通电梯产品",
    "instructionTemplates": [
        {
            "name": "take",
            "content": "take ${from} ${to}"
        }
    ],
    "resourceGroups": [
        {
            "name": "arriving_event",
            "resourceType": "EDGE",
            "trigger": {
                "type": "IMMEDIATELY"
            },
            "resources": [
                {
                    "name": "floor",
                    "dataType": "STRING",
                    "edgeKey": "currentFloor",
                    "edgeResourceType": "STATUS"
                },
                 {
                    "name": "direction",
                    "dataType": "STRING",
                    "edgeKey": "currentDirection",
                    "edgeResourceType": "STATUS"
                }
            ],
            "uri": ".edge"
        }
    ]
}
```

- 返回

```json
{
  "code": "1",
  "msg": "Success",
  "result": "32fda35b-6f41-46dc-810c-358b9148ad86"
}
```

### 示例-创建机器人产品

- 请求

```http takingRequest
POST thing/thing-models

{
    "name": "艾可机器人产品",
    "instructionTemplates": [
        {
            "name": "enter",
            "content": "enter"
        },
        {
            "name": "leave",
            "content": "leave"
        }
    ]
}
```

- 返回

```json
{
  "code": "1",
  "msg": "Success",
  "result": "240fbfed-1585-4e1b-865a-abf8ff131f41"
}
```

## 发布产品

产品创建成功后，需要先发布，才可以注册对应的设备实例（例如在梯控调度平台中电梯和机器人）

### 示例

- 请求

```http takingRequest
PUT thing/thing-models/{thingModelId}
```

- 返回

```json
{
  "code": "1",
  "msg": "Success",
  "result": null
}
```

## 创建状态监听规则

监听电梯产品的状态变更（例如梯控调度系统中，电梯侧侧的到达楼层和电梯运行方向）

### 示例

- 请求

```http takingRequest
POST /thing/rules

{
	"name": "鲁邦通电梯产品设备到达事件",
	"scope": {
        "type":"ALL",
        "clazzId": "32fda35b-6f41-46dc-810c-358b9148ad86"
    },
	"description": "电梯到达事件",
	"matchingCondition": "${uri}==\".edge.arriving_event\""
}
```

其中：  
clazzId为电梯产品标识 matchingCondition表示匹配电梯到达事件资源组

- 返回

```json
{
  "code": "1",
  "msg": "Success",
  "result": "9973994c-8fda-4453-9eb7-5b4f2283d0cf"
}
```

## 启用规则

启用规则

### 示例

- 请求

```http takingRequest
PUT thing/rules/9973994c-8fda-4453-9eb7-5b4f2283d0cf/enable
```

- 返回

```json
{
  "code": "1",
  "msg": "Success",
  "result": null
}
```